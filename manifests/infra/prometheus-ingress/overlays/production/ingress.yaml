apiVersion: projectcontour.io/v1
kind: HTTPProxy
metadata:
  name: prometheus
  namespace: monitoring
spec:
  virtualhost:
    fqdn: prometheus.cloudnativedays.jp
    tls:
      secretName: cert-manager/wildcard-cloudnativedays-jp
    authorization:
      extensionRef:
        name: prometheus-basic-auth-password
        namespace: projectcontour
  routes:
    - conditions:
      - prefix: /-/healthy
      services:
        - name: prometheus-k8s
          port: 9090
